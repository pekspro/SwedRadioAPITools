# SwedRadioAPITools

This repository contains documentation and tools for the [Sveriges Radio
API](https://sverigesradio.se/api/documentation/v2/index.html) (Swedish Radio
API). Note that **everything you find here is unofficial**. Sveriges Radio is
neither maintaining or supporting this.

The ambition of this project is to create a good OpenAPI specification that
could be used to autogenerate client code. 

## OpenAPI specification

You find an OpenAPI specification in
[Source/OpenApi/sverigesradio.yaml](Source/OpenApi/sverigesradio.yaml). This is
an attempt to make a specification of the API documented on the [official
site](https://sverigesradio.se/api/documentation/v2/index.html). There are some
caveats to be aware about:

* The API supports both XML and JSON. The specification here is only handling
  JSON. It is probably possible to add support for XML to. Should not be too
  hard, but I personally do not think it is worth the effort.
* In most rest API you handle which format you want to use with the header
  `accept: application/json`. This is not supported in this API. Instead, you
  use add `format=json` in the query string. If you do not, the response will be
  in XML. Therefore, this is a required parameter the OpenAPI specification.
* Almost everything in the official API documentation is added to the
  specification. They are a few parameters that has been left out for simplicity
  reasons.
* Date and times are tricky. In the query they are in the format `2012-08-30` or
  `2012-08-30T14:10:00Z`, this is fine. But in the response they have the format
  `/Date(1346335800000)/`. All dates used in entities are using the type
  `EntityDateTime` in the OpenAPI specification.
* All this said, this could be improved. I am far from an OpenAPI specification
  expert :-). Feel free to make contributions.

## Swagger UI

You can test the API in an UI at
[devblog.pekspro.com/SwedRadioAPITools](https://devblog.pekspro.com/SwedRadioAPITools/).
This works directly against the public API.

This is based on the [Swagger UI](https://github.com/swagger-api/swagger-ui).
The [dist](https://github.com/swagger-api/swagger-ui/tree/master/dist) folder
from this repository is copied to the [Source/SwaggerUI](Source/SwaggerUI)
folder. [Source/OpenApi/sverigesradio.yaml](Source/OpenApi/sverigesradio.yaml)
is then copied to this folder during publishing.

## .NET client

A .NET client is available at [Source/NetClient](Source/NetClient). The client
is autogenerated from the OpenAPI specification. There are also some unit tests
that is using the autogenerated client and run several quires against the public
API.

## TypeScript client

A proof of concept TypeScript client is available at
[Source/TypeScriptClient](Source/TypeScriptClient). This client code is manually
generated by [NSwagStudio](https://github.com/RicoSuter/NSwag/wiki/NSwagStudio).
The code is then executed in a browser by making a lot of call and output
everything in the console.

This is a bit of a hack :-). A NodeJS application with a lot of unit tests would
probably be a better approach.
